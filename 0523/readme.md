# System Programming 10

## 프로세스 관리

---
## 프로세스 생성

### fork() 시스템 호출
- **기능**: 부모 프로세스가 자신을 복제해 자식 프로세스를 생성, **자기 복제**
- **반환값**: 
  - 부모 프로세스: 자식의 PID 반환
  - 자식 프로세스: 0 반환
- **특징**: "한 번 호출, 두 번 리턴"

### 프로세스 동기화
- **`wait()`**: 부모가 자식 프로세스가 종료될 때까지 기다림
- **`waitpid(pid, ...)`**: 특정 자식 프로세스만 기다림

### 실습
- **`fork1.c`**: 자식 생성 후 PID 출력
```c
#include <stdio.h>
#include <unistd.h>
/* 자식 프로세스를 생성한다. */
int main() {
    int pid;
    printf("[%d] 프로세스 시작 \n", getpid());
    pid = fork();
    printf("[%d] 프로세스 : 리턴값 %d\n", getpid(), pid);
    printf("[%d] 프로세스 : 리턴값 %d\n", getpid(), pid);
    printf("[%d] 프로세스 : 리턴값 %d\n", getpid(), pid);
}
```
![image](https://github.com/user-attachments/assets/ecff5fb4-cb02-4ea3-bb23-38c660262d55)

- **`fork2.c`**: 부모/자식이 다른 메시지를 출력
- **`fork3.c`**: 두 자식 프로세스 생성

---
## 프로그램 실행

### exec() 계열 함수
- **기능**: 현재 프로세스의 메모리 공간을 새로운 프로그램으로 대체
- **특징**: 성공 시 절대 반환하지 않음
- **종류**: `execl`, `execv`, `execlp`, `execvp` 등

### 일반적인 사용 패턴
1. `fork()`로 자식 프로세스 생성
2. 자식 프로세스가 `exec()` 호출
3. 부모 프로세스는 계속 진행

### system() 함수
- **기능**: 명령어를 셸을 통해 실행
- **내부 구현**: `fork + exec + waitpid` 사용
- **반환값**: 명령 종료 코드 (정상/실패 여부 판단 가능)

---
## 입출력 재지정

### 출력 재지정
- **`dup2(fd, 1)`**: 파일 디스크립터를 표준 출력(1)에 복제
- **효과**: 출력이 파일로 저장되도록 함

### 예제 파일들
- **`redirect1.c`**: 표준출력을 파일로 변경
- **`redirect2.c`**: 자식 프로세스의 출력 결과를 파일로 저장 (`execvp` 사용)

---
## 프로세스 그룹

### 프로세스 그룹 개념
- **구성**: 하나의 그룹 리더와 그에 속한 여러 프로세스
- **조회**: `getpgrp()` - 현재 프로세스의 그룹 ID 조회
- **변경**: `setpgid(pid, pgid)` - 그룹 변경 또는 새로운 그룹 생성

### 활용 용도
- **시그널 전달**에 유용
- `kill -pid`, `waitpid()`에서 그룹 지정 가능

### 예제 파일들
- **`pgrp1.c`**: 자식은 부모의 그룹을 물려받음
- **`pgrp2.c`**: 자식이 자신만의 새로운 그룹 생성

---
## 시스템 부팅

### 부팅 단계의 주요 프로세스
- **swapper**: 커널의 스케줄러
- **init**: `/etc/inittab` 기반 초기화
- **getty/login/shell**: 사용자 로그인 처리 및 셸 실행

### 부팅 과정
- 전체 부팅 과정은 **fork/exec** 시스템 호출을 통해 진행됨
